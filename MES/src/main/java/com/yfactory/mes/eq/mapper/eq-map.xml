<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yfactory.mes.eq.mapper.EquipMapper">

	<!-- 모달창에 설비 코드와 설비명 출력 쿼리 -->
	<select id="searchEq" resultType="map">

		SELECT EQ_CD "설비코드" , EQ_NM "설비명"
		FROM EQ "eq"

	</select>

	<!-- 모달창에서 클릭한 데이터(설비코드)를 기반으로 코드와 이름을 가지고 오는 쿼리 -->
	<select id="selectEq" resultType="map">
		SELECT EQ_CD "설비코드" , EQ_NM "설비명"
		FROM EQ "eq"
		WHERE EQ_CD = #{eqCd}

	</select>
	
	<!-- 설비등록시 사원 리스트 조회 -->
	<select id="searchEmp" resultType="map">
		SELECT EMP_NO "사원번호" , EMP_NM "사원명"
		FROM EMPLOYEE 
	
	</select>


	<!-- 프로시저 컴파일 무조건 한번은 해야 mybatis 에서 프로시저를 인식합니다 -->
	<insert id="insertEq" statementType="CALLABLE"
		parameterType="com.yfactory.mes.eq.vo.EqVO">
		{CALL eq_insert(#{vdr_code},#{eq_nm}, #{eq_min}, #{eq_max}, #{eq_chkcyc},
		#{eq_mdno},#{eq_purdt}, #{eq_actst},#{eq_uph}, #{eq_inster}, #{uuid},
		#{eq_mdnm}, #{img_nm}, #{img_path})
		}
	</insert>
	
	<!-- 설비관리페이지 전체 리스트 -->
	<select id="searchEqMngList" resultType="map">
		SELECT e.eq_cd "설비코드" , e.eq_nm "설비명" , prc.proc_cd "공정코드" , prc.proc_nm
		"공정명", e.eq_min "최저온도" , e.eq_max "최고온도"
		,TO_CHAR(e.eq_purdt,'yy/MM/dd') "구매일자", CASE WHEN e.eq_actst like '1'
		THEN 'Y' ELSE 'N' END "사용여부"
		FROM eq e, process prc
		WHERE e.eq_cd = prc.eq_cd
	</select>

	<!-- 공정코드 공정명 전체조회 -->
	<select id="searchPrcList" resultType="map">
		SELECT proc_cd "공정코드" , proc_nm "공정명"
		FROM process
	</select>
	
	<!-- 공정코드 공정명 설비코드 기준 조회 -->
	<select id="selectEqPrc" resultType="map">
		SELECT proc_cd "공정코드" ,proc_nm "공정명"
		FROM process
		WHERE eq_cd = #{eqCd}
	</select>

	<!-- 업체코드 업체구분코드 업체명 전체조회 -->
	<select id="getVdrList" resultType="map">
	 <![CDATA[
		SELECT VDR_CD "업체코드", VEN_CD "업체구분코드", VDR_NM "업체명"
		FROM VENDOR VDR
		WHERE VEN_CD = 'VEN01'
		]]>
	</select>





</mapper>