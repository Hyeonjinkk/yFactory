<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yfactory.mes.proc.mapper.ProcMapper">
	<!-- 주문서 전체조회 -->
	<select id="ProcOrderSelectAll" resultType="map">
		SELECT ordtl.ordtl_cd "주문코드" ,
		TO_CHAR(ord.req_dt,'YYYY-MM-DD') "주문일자",
		TO_CHAR(ord.res_dt,'YYYY-MM-DD') "납기일자",
		ordtl.prod_cd "완제품코드" ,
		ordtl.ord_qty "주문수량",
		vdr.vdr_nm "업체명",
		pd.prod_nm "완제품명",
		cd.cd_explan "진행상황"

		FROM
		ORDERS ord,
		VENDOR vdr,
		ORD_DTL ordtl,
		PROD pd,
		COMM_CODE cd
		WHERE ord.vdr_cd = vdr.vdr_cd
		AND ord.ord_cd = ordtl.ord_cd
		AND ordtl.prod_cd
		= pd.prod_cd
		AND cd.comm_cd = ord.prog_cd
	</select>
	<!-- 주문서 단건조회 -->
	<select id="OrderSelectOk" resultType="map">
		SELECT ordtl.ordtl_cd
		"주문코드" ,
		TO_CHAR(ord.req_dt,'YYYY-MM-DD') "주문일자",
		TO_CHAR(ord.res_dt,'YYYY-MM-DD') "납기일자",
		ordtl.prod_cd "완제품코드" ,
		ordtl.ord_qty "주문수량",
		vdr.vdr_nm "업체명",
		pd.prod_nm "완제품명",
		cd.cd_explan "진행상황"
		FROM
		ORDERS ord,
		VENDOR vdr,
		ORD_DTL ordtl,
		PROD pd,
		COMM_CODE cd
		WHERE ord.vdr_cd = vdr.vdr_cd
		AND ord.ord_cd = ordtl.ord_cd
		AND ordtl.prod_cd
		= pd.prod_cd
		AND cd.comm_cd = ord.prog_cd
		AND ordtl.ordtl_cd = #{ordCd}
	</select>
	<!-- 제품 전체 조회 -->
	<select id="PrdSelect" resultType="map">
		SELECT PROD_CD "완제품코드",
		PROD_NM "완제품명"
		FROM PROD
	</select>
	<!-- 제품 단건 조회 -->
	<select id="PrdSelectOne" resultType="map">
		SELECT PROD_CD "완제품코드",
		PROD_NM "완제품명"
		FROM PROD
		WHERE PROD_CD = #{prodCd}
	</select>
	<!-- 생산 계획 전체조회 -->
	<select id="procPlanAll" resultType="map">
		SELECT pl.pp_cd "생산계획코드",
		 pl.pp_nm "계획명", 
		 TO_CHAR(pl.pp_dt,'YYYY-MM-DD') "계획일자", 
		 dtl.pd_qty "계획량"
		FROM PRDT_PL pl, PLAN_DTL dtl
		WHERE pl.pp_cd = dtl.pp_cd
	</select>
	<!-- 생산 계획 전체조회 -->
		<select id="prdtPlanSelect" resultType="map">
		SELECT  pl.pp_cd "생산계획코드",
		 		pl.pp_nm "계획명", 
		 		TO_CHAR(pl.pp_dt,'YYYY-MM-DD') "계획일자", 
		 		dtl.pd_qty "계획량"
				FROM PRDT_PL pl, PLAN_DTL dtl
				WHERE pl.pp_cd = dtl.pp_cd
		<if test="date1 != '' and date2 != ''">				
        		AND   pl.pp_dt BETWEEN TO_DATE(#{date1},'YY/MM/DD') AND TO_DATE(#{date2},'YY/MM/DD')
        </if>
	</select>
	<insert id="ProcPlanInsert">

	</insert>
</mapper>